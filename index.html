<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SFW متجر إلكتروني</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
  <style>
    :root {
      --primary-color: #ff4d6d;
      --secondary-color: #c9184a;
      --text-color: #333;
      --light-bg: #fdfbfb;
      --card-bg: #ffffff;
      --border-radius: 12px;
      --box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Cairo', sans-serif;
      direction: rtl;
      margin: 0;
      padding: 0;
      background: var(--light-bg);
      color: var(--text-color);
      min-height: 100vh;
      line-height: 1.6;
    }
    
    header {
      background-color: rgba(255, 255, 255, 0.95);
      padding: 12px 16px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 999;
      width: 100%;
    }
    
    .welcome {
      font-size: 1.1rem;
      font-weight: bold;
      color: #d63384;
      text-align: center;
      margin-bottom: 10px;
      animation: glow 2s ease-in-out infinite alternate;
    }
    
    @keyframes glow {
      from { text-shadow: 0 0 5px #ffc6e0; }
      to { text-shadow: 0 0 15px #ff99c8; }
    }
    
    .login-form {
      display: flex;
      gap: 8px;
      width: 100%;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .login-form input {
      flex: 1;
      min-width: 120px;
      padding: 8px 12px;
      border-radius: var(--border-radius);
      border: 1px solid #ddd;
      font-family: 'Cairo';
      font-size: 0.9rem;
    }
    
    .login-form button {
      padding: 8px 16px;
      font-size: 0.9rem;
    }
    
    h1, h2, h3 {
      color: var(--primary-color);
      margin: 1rem 0;
    }
    
    h1 {
      font-size: 1.8rem;
      text-align: center;
      padding: 0 16px;
    }
    
    h2 {
      font-size: 1.5rem;
      text-align: center;
    }
    
    h3 {
      font-size: 1.2rem;
    }
    
    #products, .admin-products {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
      padding: 16px;
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .card {
      border: 1px solid #eee;
      padding: 16px;
      background: var(--card-bg);
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      transition: transform 0.3s, box-shadow 0.3s;
      display: flex;
      flex-direction: column;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    }
    
    .card img {
      width: 100%;
      height: 180px;
      object-fit: cover;
      border-radius: var(--border-radius);
      margin-bottom: 12px;
    }
    
    .order-form, .edit-form, .about-section, .contact-section {
      display: none;
      margin-top: 12px;
      background: #f9f9f9;
      padding: 12px;
      border-radius: var(--border-radius);
    }
    
    input, textarea, button {
      width: 100%;
      padding: 10px 12px;
      border-radius: var(--border-radius);
      border: 1px solid #ddd;
      font-family: 'Cairo';
      font-size: 0.95rem;
      margin: 6px 0;
    }
    
    textarea {
      min-height: 100px;
      resize: vertical;
    }
    
    button {
      background-color: var(--primary-color);
      color: white;
      border: none;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s, transform 0.2s;
      margin: 8px 0;
    }
    
    button:hover {
      background-color: var(--secondary-color);
      transform: scale(1.02);
    }
    
    button:active {
      transform: scale(0.98);
    }
    
    /* التعديلات الخاصة بالتفاصيل */
    .product-details {
      max-height: 80px;
      overflow: hidden;
      position: relative;
      margin: 8px 0;
    }
    
    .product-details.expanded {
      max-height: none;
      overflow: visible;
    }
    
    .show-more {
      color: var(--primary-color);
      cursor: pointer;
      text-align: left;
      margin: 5px 0;
      font-weight: bold;
      font-size: 0.9rem;
    }
    
    /* لوحة التحكم */
    .admin-section {
      display: none;
      padding: 16px;
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .admin-tabs {
      display: flex;
      margin-bottom: 20px;
      border-bottom: 1px solid #ddd;
      overflow-x: auto;
      white-space: nowrap;
      -webkit-overflow-scrolling: touch;
    }
    
    .admin-tab {
      padding: 10px 20px;
      cursor: pointer;
      background: #f5f5f5;
      margin-left: 5px;
      border-radius: 8px 8px 0 0;
      font-size: 0.95rem;
    }
    
    .admin-tab.active {
      background: var(--primary-color);
      color: white;
    }
    
    .admin-tab-content {
      display: none;
      padding: 10px 0;
    }
    
    .admin-tab-content.active {
      display: block;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 16px 0;
      font-size: 0.9rem;
    }
    
    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
    }
    
    th {
      background-color: #f5f5f5;
    }
    
    .main-store {
      display: block;
    }
    
    .admin-logged-in .main-store {
      display: none;
    }
    
    .top-buttons {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 15px 0;
    }
    
    .top-buttons button {
      width: auto;
      padding: 10px 20px;
    }
    
    /* تعديلات للهواتف الصغيرة */
    @media (max-width: 480px) {
      .welcome {
        font-size: 1rem;
      }
      
      h1 {
        font-size: 1.5rem;
      }
      
      #products, .admin-products {
        grid-template-columns: 1fr;
        padding: 10px;
      }
      
      .card {
        width: 100%;
      }
      
      .admin-tab {
        padding: 8px 12px;
        font-size: 0.85rem;
      }
      
      .login-form input, .login-form button {
        padding: 8px;
        font-size: 0.85rem;
      }
      
      .top-buttons {
        flex-direction: column;
        align-items: center;
      }
      
      .top-buttons button {
        width: 80%;
      }
    }
    
    /* تعديلات للأجهزة اللوحية */
    @media (min-width: 481px) and (max-width: 768px) {
      #products, .admin-products {
        grid-template-columns: repeat(2, 1fr);
      }
    }
    
    /* تعديلات لأجهزة الكمبيوتر */
    @media (min-width: 769px) {
      header {
        flex-direction: row;
        justify-content: space-between;
        padding: 15px 30px;
      }
      
      .welcome {
        margin-bottom: 0;
        font-size: 1.2rem;
      }
      
      .login-form {
        width: auto;
        flex-wrap: nowrap;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="welcome">🌟 مرحباً بك في SFW! تسوّق بذكاء واكتشف كل جديد! 🌟</div>
    <div class="login-form">
      <input type="text" id="adminUser" placeholder="اسم المستخدم">
      <input type="password" id="adminPass" placeholder="كلمة المرور">
      <button onclick="loginAdmin()">دخول</button>
    </div>
  </header>

  <div class="main-store">
    <div class="top-buttons">
      <button onclick="showAboutSection()">من نحن</button>
      <button onclick="showContactSection()">تواصل معنا</button>
    </div>
    
    <div class="about-section" id="aboutSection">
      <h2>من نحن</h2>
      <p>نحن شركة متخصصة في تقديم حلول رقمية متكاملة، تشمل تصميم وتطوير المتاجر الإلكترونية، وتطبيقات إدارة الأنشطة بمختلف أنواعها. كما نُبدع في تصميم الهويات البصرية وابتكار محتوى احترافي للسوشيال ميديا يعزز حضور علامتك التجارية ويُبرز تميزك في السوق.</p>
      <button onclick="hideAboutSection()">العودة</button>
    </div>
    
    <div class="contact-section" id="contactSection">
      <h2>تواصل معنا</h2>
      <p>البريد الإلكتروني: dodsmart7@gmail.com</p>
      <input type="text" id="contactName" placeholder="اسمك">
      <input type="email" id="contactEmail" placeholder="بريدك الإلكتروني">
      <textarea id="contactMessage" placeholder="رسالتك"></textarea>
      <button onclick="sendContactMessage()">إرسال الرسالة</button>
      <button onclick="hideContactSection()">إلغاء</button>
    </div>
    
    <h1>معروضات المتجر</h1>
    <div id="products"></div>
  </div>

  <div class="admin-section">
    <button onclick="logoutAdmin()">خروج الأدمن</button>
    
    <div class="admin-tabs">
      <div class="admin-tab active" onclick="switchAdminTab('products-tab')">معروضات المتجر</div>
      <div class="admin-tab" onclick="switchAdminTab('add-tab')">إضافة منتج</div>
      <div class="admin-tab" onclick="switchAdminTab('orders-tab')">طلبات الشراء</div>
      <div class="admin-tab" onclick="switchAdminTab('messages-tab')">رسائل العملاء</div>
    </div>
    
    <div id="products-tab" class="admin-tab-content active">
      <h2>إدارة معروضات المتجر</h2>
      <div class="admin-products" id="adminProducts"></div>
    </div>
    
    <div id="add-tab" class="admin-tab-content">
      <h2>إضافة منتج جديد</h2>
      <div class="admin-panel">
        <input type="text" id="productName" placeholder="اسم المنتج">
        <input type="text" id="productPrice" placeholder="السعر">
        <textarea id="productDetails" placeholder="التفاصيل"></textarea>
        <input type="file" id="productImageFile" accept="image/*">
        <button onclick="addProduct()">إضافة منتج</button>
      </div>
    </div>
    
    <div id="orders-tab" class="admin-tab-content">
      <h2>طلبات الشراء</h2>
      <table id="ordersTable">
        <tr><th>المنتج</th><th>الكمية</th><th>العميل</th><th>الهاتف</th><th>العنوان</th><th>إجراء</th></tr>
      </table>
    </div>
    
    <div id="messages-tab" class="admin-tab-content">
      <h2>رسائل العملاء</h2>
      <table id="messagesTable">
        <tr><th>الاسم</th><th>البريد الإلكتروني</th><th>الرسالة</th><th>التاريخ</th><th>إجراء</th></tr>
      </table>
    </div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyC0BkNX-62lynXzcGxhLu3QiJLvU4vOQOM",
      authDomain: "sfw-online-store.firebaseapp.com",
      databaseURL: "https://sfw-online-store-default-rtdb.firebaseio.com",
      projectId: "sfw-online-store",
      storageBucket: "sfw-online-store.appspot.com",
      messagingSenderId: "98460253065",
      appId: "1:98460253065:web:2837e86960f8d799cbff58",
      measurementId: "G-TFRHLFMMJV"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function renderProducts() {
      db.ref('products').on('value', snapshot => {
        const container = document.getElementById('products');
        container.innerHTML = '';
        snapshot.forEach(child => {
          const data = child.val();
          const key = child.key;
          const card = document.createElement('div');
          card.className = 'card';
          
          let showMoreBtn = '';
          if (data.details.length > 150) {
            showMoreBtn = '<div class="show-more" onclick="toggleDetails(this)">المزيد ▼</div>';
          }
          
          card.innerHTML = `
            <img src="${data.image}" alt="صورة المنتج">
            <h3>${data.name}</h3>
            <div class="product-details">${data.details}</div>
            ${showMoreBtn}
            <p><strong>${data.price} جنيه</strong></p>
            <button onclick="showOrderForm('${key}')">طلب شراء</button>
            <div class="order-form" id="order-form-${key}">
              <h3>طلب شراء ${data.name}</h3>
              <input type="number" min="1" value="1" placeholder="الكمية" id="qty-${key}">
              <input type="text" placeholder="اسمك" id="name-${key}">
              <input type="tel" placeholder="رقم الهاتف" id="phone-${key}">
              <input type="text" placeholder="العنوان" id="address-${key}">
              <div style="display: flex; gap: 10px;">
                <button style="flex: 1;" onclick="submitOrder('${key}', '${data.name}')">حفظ الطلب</button>
                <button style="flex: 1; background: #6c757d;" onclick="hideOrderForm('${key}')">إلغاء</button>
              </div>
            </div>
          `;
          container.appendChild(card);
        });
      });
    }

    function renderAdminProducts() {
      db.ref('products').on('value', snapshot => {
        const container = document.getElementById('adminProducts');
        container.innerHTML = '';
        snapshot.forEach(child => {
          const data = child.val();
          const key = child.key;
          const card = document.createElement('div');
          card.className = 'card';
          
          let showMoreBtn = '';
          if (data.details.length > 100) {
            showMoreBtn = '<div class="show-more" onclick="toggleDetails(this)">المزيد ▼</div>';
          }
          
          card.innerHTML = `
            <img src="${data.image}" alt="صورة المنتج">
            <h3>${data.name}</h3>
            <div class="product-details">${data.details}</div>
            ${showMoreBtn}
            <p><strong>${data.price} جنيه</strong></p>
            <button onclick="showEditForm('${key}')">تعديل</button>
            <button onclick="deleteProduct('${key}')">حذف</button>
            <div class="edit-form" id="edit-form-${key}">
              <input type="text" id="edit-name-${key}" value="${data.name}" placeholder="اسم المنتج">
              <input type="text" id="edit-price-${key}" value="${data.price}" placeholder="السعر">
              <textarea id="edit-details-${key}" placeholder="التفاصيل">${data.details}</textarea>
              <button onclick="updateProduct('${key}')">حفظ التعديلات</button>
              <button onclick="hideEditForm('${key}')">إلغاء</button>
            </div>
          `;
          container.appendChild(card);
        });
      });
    }

    function toggleDetails(element) {
      const detailsDiv = element.previousElementSibling;
      detailsDiv.classList.toggle('expanded');
      element.textContent = detailsDiv.classList.contains('expanded') ? 'إخفاء ▲' : 'المزيد ▼';
    }

    function showOrderForm(id) {
      document.getElementById(`order-form-${id}`).style.display = 'block';
    }

    function hideOrderForm(id) {
      document.getElementById(`order-form-${id}`).style.display = 'none';
    }

    function submitOrder(id, productName) {
      const qty = document.getElementById(`qty-${id}`).value;
      const name = document.getElementById(`name-${id}`).value;
      const phone = document.getElementById(`phone-${id}`).value;
      const address = document.getElementById(`address-${id}`).value;
      
      if (!qty || parseInt(qty) < 1) return alert('الكمية يجب أن تكون رقم موجب');
      if (!name) return alert('يرجى إدخال اسمك');
      if (!phone) return alert('يرجى إدخال رقم الهاتف');
      if (!address) return alert('يرجى إدخال العنوان');
      
      db.ref('orders').push({ 
        productName, 
        qty, 
        name, 
        phone, 
        address,
        timestamp: firebase.database.ServerValue.TIMESTAMP
      });
      
      alert('تم إرسال الطلب بنجاح');
      hideOrderForm(id);
      
      // مسح حقول الطلب
      document.getElementById(`qty-${id}`).value = '1';
      document.getElementById(`name-${id}`).value = '';
      document.getElementById(`phone-${id}`).value = '';
      document.getElementById(`address-${id}`).value = '';
    }

    function loginAdmin() {
      const user = document.getElementById('adminUser').value;
      const pass = document.getElementById('adminPass').value;
      if (user === 'admin' && pass === '1234') {
        document.querySelector('.admin-section').style.display = 'block';
        document.querySelector('.login-form').style.display = 'none';
        document.body.classList.add('admin-logged-in');
        loadOrders();
        loadMessages();
        renderAdminProducts();
      } else {
        alert('بيانات الدخول غير صحيحة');
      }
    }

    function logoutAdmin() {
      document.querySelector('.admin-section').style.display = 'none';
      document.querySelector('.login-form').style.display = 'flex';
      document.body.classList.remove('admin-logged-in');
    }

    function switchAdminTab(tabId) {
      document.querySelectorAll('.admin-tab-content').forEach(content => {
        content.classList.remove('active');
      });
      
      document.querySelectorAll('.admin-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      document.getElementById(tabId).classList.add('active');
      document.querySelector(`.admin-tab[onclick="switchAdminTab('${tabId}')"]`).classList.add('active');
      
      if (tabId === 'orders-tab') {
        loadOrders();
      } else if (tabId === 'products-tab') {
        renderAdminProducts();
      } else if (tabId === 'messages-tab') {
        loadMessages();
      }
    }

    function addProduct() {
      const name = document.getElementById('productName').value;
      const price = document.getElementById('productPrice').value;
      const details = document.getElementById('productDetails').value;
      const fileInput = document.getElementById('productImageFile');
      
      if (!name || !price || !details) {
        return alert('يرجى ملء جميع الحقول');
      }
      
      if (!fileInput.files[0]) {
        return alert('يرجى اختيار صورة للمنتج');
      }
      
      const reader = new FileReader();
      reader.onload = function(event) {
        const imageData = event.target.result;
        db.ref('products').push({ 
          name, 
          price, 
          details, 
          image: imageData,
          createdAt: firebase.database.ServerValue.TIMESTAMP
        });
        
        alert('تمت إضافة المنتج بنجاح');
        document.getElementById('productName').value = '';
        document.getElementById('productPrice').value = '';
        document.getElementById('productDetails').value = '';
        fileInput.value = '';
        
        switchAdminTab('products-tab');
      };
      reader.readAsDataURL(fileInput.files[0]);
    }

    function showEditForm(productId) {
      document.getElementById(`edit-form-${productId}`).style.display = 'block';
    }

    function hideEditForm(productId) {
      document.getElementById(`edit-form-${productId}`).style.display = 'none';
    }

    function updateProduct(productId) {
      const name = document.getElementById(`edit-name-${productId}`).value;
      const price = document.getElementById(`edit-price-${productId}`).value;
      const details = document.getElementById(`edit-details-${productId}`).value;
      
      if (!name || !price || !details) {
        return alert('يرجى ملء جميع الحقول');
      }
      
      db.ref('products/' + productId).update({
        name: name,
        price: price,
        details: details,
        updatedAt: firebase.database.ServerValue.TIMESTAMP
      });
      
      alert('تم تحديث المنتج بنجاح');
      hideEditForm(productId);
    }

    function deleteProduct(productId) {
      if (confirm('هل أنت متأكد من حذف هذا المنتج؟')) {
        db.ref('products/' + productId).remove();
        alert('تم حذف المنتج بنجاح');
      }
    }

    function loadOrders() {
      db.ref('orders').orderByChild('timestamp').on('value', snapshot => {
        const table = document.getElementById('ordersTable');
        table.innerHTML = '<tr><th>المنتج</th><th>الكمية</th><th>العميل</th><th>الهاتف</th><th>العنوان</th><th>إجراء</th></tr>';
        
        const orders = [];
        snapshot.forEach(child => {
          orders.push({
            key: child.key,
            ...child.val()
          });
        });
        
        // عرض الطلبات من الأحدث إلى الأقدم
        orders.reverse().forEach(order => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${order.productName}</td>
            <td>${order.qty}</td>
            <td>${order.name}</td>
            <td>${order.phone}</td>
            <td>${order.address}</td>
            <td><button onclick="deleteOrder('${order.key}')">تم التنفيذ</button></td>
          `;
          table.appendChild(row);
        });
      });
    }

    function deleteOrder(orderId) {
      if (confirm('هل تم تنفيذ هذا الطلب؟')) {
        db.ref('orders/' + orderId).remove();
      }
    }
    
    function showAboutSection() {
      document.getElementById('aboutSection').style.display = 'block';
      document.getElementById('products').style.display = 'none';
      document.querySelector('.main-store h1').style.display = 'none';
    }
    
    function hideAboutSection() {
      document.getElementById('aboutSection').style.display = 'none';
      document.getElementById('products').style.display = 'grid';
      document.querySelector('.main-store h1').style.display = 'block';
    }
    
    function showContactSection() {
      document.getElementById('contactSection').style.display = 'block';
      document.getElementById('products').style.display = 'none';
      document.querySelector('.main-store h1').style.display = 'none';
    }
    
    function hideContactSection() {
      document.getElementById('contactSection').style.display = 'none';
      document.getElementById('products').style.display = 'grid';
      document.querySelector('.main-store h1').style.display = 'block';
    }
    
    function sendContactMessage() {
      const name = document.getElementById('contactName').value;
      const email = document.getElementById('contactEmail').value;
      const message = document.getElementById('contactMessage').value;
      
      if (!name || !email || !message) {
        return alert('يرجى ملء جميع الحقول');
      }
      
      db.ref('messages').push({
        name: name,
        email: email,
        message: message,
        timestamp: firebase.database.ServerValue.TIMESTAMP
      });
      
      alert('تم إرسال رسالتك بنجاح، شكراً لتواصلك معنا!');
      document.getElementById('contactName').value = '';
      document.getElementById('contactEmail').value = '';
      document.getElementById('contactMessage').value = '';
      hideContactSection();
    }
    
    function loadMessages() {
      db.ref('messages').orderByChild('timestamp').on('value', snapshot => {
        const table = document.getElementById('messagesTable');
        table.innerHTML = '<tr><th>الاسم</th><th>البريد الإلكتروني</th><th>الرسالة</th><th>التاريخ</th><th>إجراء</th></tr>';
        
        const messages = [];
        snapshot.forEach(child => {
          messages.push({
            key: child.key,
            ...child.val()
          });
        });
        
        // عرض الرسائل من الأحدث إلى الأقدم
        messages.reverse().forEach(msg => {
          const date = new Date(msg.timestamp);
          const dateStr = date.toLocaleDateString('ar-EG') + ' ' + date.toLocaleTimeString('ar-EG');
          
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${msg.name}</td>
            <td>${msg.email}</td>
            <td>${msg.message}</td>
            <td>${dateStr}</td>
            <td><button onclick="deleteMessage('${msg.key}')">حذف</button></td>
          `;
          table.appendChild(row);
        });
      });
    }
    
    function deleteMessage(messageId) {
      if (confirm('هل تريد حذف هذه الرسالة؟')) {
        db.ref('messages/' + messageId).remove();
      }
    }

    // تحميل المنتجات عند بدء التشغيل
    document.addEventListener('DOMContentLoaded', renderProducts);
  </script>
</body>
</html>
